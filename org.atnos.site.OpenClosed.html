<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Open - Closed</title>
    <link href="./css/opensans-fonts.css"                          type="text/css" rel="stylesheet" />
    <link href="./css/bootstrap.min.css"                           type="text/css" rel="stylesheet" />
    <link href="./css/font-awesome.min.css"                        type="text/css" rel="stylesheet" />
    <link href="./css/prettify.css"                                type="text/css" rel="stylesheet" />
    <link href="./css/tabber.css"                                  type="text/css" rel="stylesheet" />
    <link href="./css/tipuesearch.css"                             type="text/css" rel="stylesheet" />
    <link href="./css/specs2.css"                                  type="text/css" rel="stylesheet" />
    <link href="./css/specs2-user.css"                             type="text/css" rel="stylesheet" />

    <script src="./javascript/jquery.js"                           type="text/javascript"></script>
    <script src="./javascript/jquery.jstree.js"                    type="text/javascript"></script>
    <script src="./javascript/tabber.js"                           type="text/javascript"></script>
    <script src="./javascript/tabber_start.js"                     type="text/javascript"></script>
    <script src="./javascript/prettify.js"                         type="text/javascript"></script>
    <script src="./javascript/specs2.js"                           type="text/javascript"></script>
    <script src="./javascript/specs2-user.js"                      type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch_set.js"      type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch_contents.js" type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch.min.js"      type="text/javascript"></script>

</head>
<body onload="prettyPrint()">

<div class="container">

<div class="col-md-1"></div>

<div class="col-md-1"></div>




<div class="col-md-10">
<h1>Open - Closed</h1>
<div id="tipue_search_content"></div>

<p>There are 2 ways to create effectful computations for a given effect <code class="prettyprint">M</code>.</p>
<p>You can create an <strong>open</strong> union of effects:</p>
<pre><code class="prettyprint">// &#39;&lt;= &#39; reads &#39;is member of &#39;
import Member.&lt;=
import StateEffect._
import WriterEffect._

def putAndTell[R](i: Int)(implicit s: State[Int, ?] &lt;= R, w: Writer[String, ?] &lt;= R): Eff[R, Int] =
  for {
    _ &lt;- put(i)
    _ &lt;- tell(&quot;stored &quot; + i)
  } yield i</code></pre>
<p>In this case you don’t fix the type of the effect stack to use, you just list the effects that the stack will contain.</p>
<p>This has several advantages:</p>
<ul>
<li><p>you can add more effects later to the <code class="prettyprint">Eff[R, Int]</code> action being created</p></li>
<li><p>the <code class="prettyprint">putAndTell</code> method can be used in different effect stacks as long as they have the <code class="prettyprint">StateInt</code> and <code class="prettyprint">WriterString</code> effects</p></li>
<li><p>no type annotations are required in the for comprehension</p></li>
</ul>
<p>On the other hand:</p>
<ul>
<li><p>this is verbose if you have lots of methods like this, always operating on the same stack of effects</p></li>
<li><p>you might want to “seal” the stack to declare exactly with which set of effects you want to be working</p></li>
</ul>
<p>In that case you can specify an effect stack:</p>
<pre><code class="prettyprint">import org.atnos.eff._, all._
import cats.syntax.all._
import cats.data._

type S = State[Int, ?] |: Writer[String, ?] |: NoEffect

object S {

  implicit val StateIntMember: Member.Aux[State[Int, ?], S, Writer[String, ?] |: NoEffect] =
    Member.ZeroMember

  implicit val WriterStringMember: Member.Aux[Writer[String, ?], S, State[Int, ?] |: NoEffect] =
    Member.SuccessorMember

}

import S._

def putAndTell(i: Int): Eff[S, Int] =
  for {
    _ &lt;- put(i)
    _ &lt;- tell(&quot;stored &quot;+i)
  } yield i</code></pre>
<p>One major issue with this approach is that you will need to define one implicit for each effect that is member of the stack. The implicit <code class="prettyprint">StateIntMember</code> for example declares that:</p>
<ul>
<li><p><code class="prettyprint">State[Int, ?]</code> is a member of <code class="prettyprint">S</code></p></li>
<li><p>if you remove <code class="prettyprint">State[Int, ?]</code> from <code class="prettyprint">S</code>, you are left with the <code class="prettyprint">Writer[String, ?] |: NoEffect</code> stack</p></li>
</ul>
<p><br/> Now you can learn <link class="ok"><a href="org.atnos.site.CreateEffects.html" tooltip="" class="ok">how to create effects</a></link></p>
</div>

</div>

</body>
</html>